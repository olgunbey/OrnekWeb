

<script src="https://code.jquery.com/jquery-3.7.0.js"
        integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM="
        crossorigin="anonymous"></script>
<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
<link rel="stylesheet" href="~/IdentityServer4.Client.styles.css" asp-append-version="true" />
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" asp-action="Index" asp-controller="Home">E-Ticaret</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">

        <ul class="navbar-nav">
        </ul>

    </div>
</nav>

<div class="container">
    <main role="main" class="pb-3">
        @RenderBody()
    </main>
</div>
            
          <script>
    const ul=document.querySelector(".navbar-nav");


    function makeProtectedApiCall(accessToken) {
        $.ajax({
            type: 'GET',
            url: 'https://localhost:7237/api/Urunler/ThreeChildKategoryiesList',
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + accessToken);
            },
            success: function (data) {
              var  oneChildKategori = data.data.oneChildKategorilerDtos;
              var  threeChildKategori = data.data.threeChildKategoriDtos;
              var  TwoChildKategori = data.data.twoChildKategorilerDtos;

                for (let category of threeChildKategori) {
                    var createli = document.createElement("li");
                    createli.className = "categoryli";
                    var createa = document.createElement("a");
                    createa.className = "categorya";
                    createa.className = "nav-link";
                    createa.textContent = category.threeChildKategoriName;
                    createli.appendChild(createa);
                    ul.appendChild(createli);



                    for (twoChildCategories of TwoChildKategori) {
                        if (twoChildCategories.threeChildID == category.id) {
                            var createsubli = document.createElement("li");
                            createsubli.className = "categoryli";
                            var createsuba = document.createElement("a");
                            createsuba.textContent = twoChildCategories.twoChildKategoriName;
                            createsuba.style.color = "red";
                            createsuba.href = `/Urunler/Ustkategori?kategori=${twoChildCategories.twoChildKategoriName}`
                            createsuba.className = "categorya";
                            createsuba.className = "nav-link";
                            createsubli.appendChild(createsuba);
                            createli.appendChild(createsubli);


                            for (oneChildCategories of oneChildKategori) {
                                if (oneChildCategories.twoChildKategorilerDto != null) {
                                    if (twoChildCategories.id == oneChildCategories.twoChildKategoriID) {
                                        var createsubsubli = document.createElement("li");
                                        createsubsubli.className = "categoryli";
                                        var createsubsuba = document.createElement("a");
                                        createsubsuba.style.color = "orange";
                                        createsubsuba.textContent = oneChildCategories.oneChildKategoriName;
                                        createsubsuba.href = `/Urunler/AltKategori?kategories=${oneChildCategories.oneChildKategoriName}`;
                                        createsubsuba.className = "categorya";
                                        createsubsuba.className = "nav-link";
                                        createsubsubli.appendChild(createsubsuba);
                                        createsubli.appendChild(createsubsubli);
                                    }
                                }
                                if (oneChildCategories.threeChildKategoriDto != null) {
                                    if (oneChildCategories.threeChildKategoriID == category.id) {
                                        var anasubli = document.createElement("li");
                                        anasubli.className = "categoryli";
                                        var anasubba = document.createElement("a");
                                        anasubba.style.color = "orange";
                                        anasubba.textContent = oneChildCategories.oneChildKategoriName;
                                        anasubba.href = `/Urunler/AltKategori?kategories=${oneChildCategories.oneChildKategoriName}`;
                                        anasubba.className = "categorya";
                                        anasubba.className = "nav-link";
                                        anasubli.appendChild(anasubba);
                                        createli.appendChild(anasubli);
                                    }
                                }
                            }
                        }
                    }
                    for (oneChildCategories of oneChildKategori) {
                        if (oneChildCategories.twoChildKategorilerDto != null) {
                            if (twoChildCategories.id == oneChildCategories.twoChildKategoriID) {
                                var createsubsubli = document.createElement("li");
                                createsubsubli.className = "categoryli";
                                var createsubsuba = document.createElement("a");
                                createsubsuba.style.color = "orange";
                                createsubsuba.textContent = oneChildCategories.oneChildKategoriName;
                                createsubsuba.href = `/Urunler/AltKategori?kategories=${oneChildCategories.oneChildKategoriName}`;
                                createsubsuba.className = "categorya";
                                createsubsuba.className = "nav-link";
                                createsubsubli.appendChild(createsubsuba);
                                createsubli.appendChild(createsubsubli);
                            }
                        }
                        if (oneChildCategories.threeChildKategoriDto != null) {
                            if (oneChildCategories.threeChildKategoriID == category.id) {
                                var anasubli = document.createElement("li");
                                anasubli.className = "categoryli";
                                var anasubba = document.createElement("a");
                                anasubba.style.color = "orange";
                                anasubba.textContent = oneChildCategories.oneChildKategoriName;
                                anasubba.href = `/Urunler/AltKategori?kategories=${oneChildCategories.oneChildKategoriName}`;
                                anasubba.className = "categorya";
                                anasubba.className = "nav-link";
                                anasubli.appendChild(anasubba);
                                createli.appendChild(anasubli);
                            }
                        }
                    }
                }

            },
            error: function (error) {
                console.error('Error:', error);
            },
        });
    }
   
    function getAccessToken()
    {
        return $.ajax({
            type: 'POST',
            url: 'https://localhost:7291/connect/token',
            data: {
                grant_type: 'client_credentials',
                client_id: 'Client1',
                client_secret: 'secret'
            },
        });
    }


    getAccessToken().done(function (accessTokenResponse) {
        var accessToken = accessTokenResponse.access_token;

        // Make the AJAX GET request to the protected API with the access token
        makeProtectedApiCall(accessToken);
    });


    for(let category of threeChildKategori)
    {
        var createli = document.createElement("li");
        createli.className = "categoryli";
        var createa = document.createElement("a");
        createa.className = "categorya";
        createa.className="nav-link";
        createa.textContent = category.threeChildKategoriName;
        createli.appendChild(createa);
        ul.appendChild(createli);       
         


        for(twoChildCategories of TwoChildKategori)
        {
            if (twoChildCategories.threeChildID == category.id) 
            {
                var createsubli = document.createElement("li");
                createsubli.className = "categoryli";
                var createsuba = document.createElement("a");
                createsuba.textContent = twoChildCategories.twoChildKategoriName;
                createsuba.style.color="red";
                createsuba.href = `/Urunler/Ustkategori?kategori=${twoChildCategories.twoChildKategoriName}`
                createsuba.className = "categorya";
                createsuba.className = "nav-link";
                createsubli.appendChild(createsuba);
                createli.appendChild(createsubli);


                for(oneChildCategories of oneChildKategori)
                {
                    if (oneChildCategories.twoChildKategorilerDto != null)
                    {
                        if (twoChildCategories.id == oneChildCategories.twoChildKategoriID)
                        {
                            var createsubsubli = document.createElement("li");
                            createsubsubli.className = "categoryli";
                            var createsubsuba = document.createElement("a");
                            createsubsuba.style.color="orange";
                            createsubsuba.textContent = oneChildCategories.oneChildKategoriName;
                            createsubsuba.href = `/Urunler/AltKategori?kategories=${oneChildCategories.oneChildKategoriName}`;
                            createsubsuba.className = "categorya";
                            createsubsuba.className = "nav-link";
                            createsubsubli.appendChild(createsubsuba);
                            createsubli.appendChild(createsubsubli);
                        }
                    }
                    if (oneChildCategories.threeChildKategoriDto != null) 
                    {
                        if (oneChildCategories.threeChildKategoriID == category.id)
                        {
                            var anasubli = document.createElement("li");
                            anasubli.className = "categoryli";
                            var anasubba = document.createElement("a");
                            anasubba.style.color="orange";
                            anasubba.textContent = oneChildCategories.oneChildKategoriName;
                            anasubba.href = `/Urunler/AltKategori?kategories=${oneChildCategories.oneChildKategoriName}`;
                            anasubba.className = "categorya";
                            anasubba.className = "nav-link";
                            anasubli.appendChild(anasubba);
                            createli.appendChild(anasubli);
                        }
                    }
                }
            }
        }
        for (oneChildCategories of oneChildKategori) {
            if (oneChildCategories.twoChildKategorilerDto != null) {
                if (twoChildCategories.id == oneChildCategories.twoChildKategoriID) {
                    var createsubsubli = document.createElement("li");
                    createsubsubli.className = "categoryli";
                    var createsubsuba = document.createElement("a");
                    createsubsuba.style.color = "orange";
                    createsubsuba.textContent = oneChildCategories.oneChildKategoriName;
                    createsubsuba.href = `/Urunler/AltKategori?kategories=${oneChildCategories.oneChildKategoriName}`;
                    createsubsuba.className = "categorya";
                    createsubsuba.className = "nav-link";
                    createsubsubli.appendChild(createsubsuba);
                    createsubli.appendChild(createsubsubli);
                }
            }
            if (oneChildCategories.threeChildKategoriDto != null) {
                if (oneChildCategories.threeChildKategoriID == category.id) {
                    var anasubli = document.createElement("li");
                    anasubli.className = "categoryli";
                    var anasubba = document.createElement("a");
                    anasubba.style.color = "orange";
                    anasubba.textContent = oneChildCategories.oneChildKategoriName;
                    anasubba.href = `/Urunler/AltKategori?kategories=${oneChildCategories.oneChildKategoriName}`;
                    anasubba.className = "categorya";
                    anasubba.className = "nav-link";
                    anasubli.appendChild(anasubba);
                    createli.appendChild(anasubli);
                }
            }
        }
    }
          </script>
